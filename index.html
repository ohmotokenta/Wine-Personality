import React, { useState, useEffect } from 'react';
import { Wine, GlassWater, PartyPopper, Heart, ArrowRight, RefreshCw, Share2, ShoppingBag, Star, Music, Coffee, BookOpen } from 'lucide-react';

export default function WineDiagnosisApp() {
  const [step, setStep] = useState('intro'); // intro, quiz, analyzing, result
  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
  const [scores, setScores] = useState({
    sparkling: 0, // å¤–å‘çš„ãƒ»æ„Ÿè¦šçš„ï¼ˆãƒ ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼ï¼‰
    white: 0,     // å¤–å‘çš„ãƒ»è«–ç†çš„ï¼ˆå†’é™ºå®¶ãƒ»ã‚µãƒã‚µãƒï¼‰
    lightRed: 0,  // å†…å‘çš„ãƒ»æ„Ÿè¦šçš„ï¼ˆèŠ¸è¡“å®¶ãƒ»ãƒ­ãƒãƒ³ãƒã‚¹ãƒˆï¼‰
    heavyRed: 0   // å†…å‘çš„ãƒ»è«–ç†çš„ï¼ˆãƒªãƒ¼ãƒ€ãƒ¼ãƒ»ã“ã ã‚ã‚Šï¼‰
  });
  const [result, setResult] = useState(null);

  // è³ªå•ãƒ‡ãƒ¼ã‚¿
  const questions = [
    {
      id: 1,
      text: "ä¼‘æ—¥ã®ç†æƒ³çš„ãªéã”ã—æ–¹ã¯ï¼Ÿ",
      icon: <SunIcon />,
      options: [
        { text: "ã¿ã‚“ãªã§ãƒ¯ã‚¤ãƒ¯ã‚¤BBQã‚„ãƒ©ãƒ³ãƒ", type: "sparkling", weight: 2 },
        { text: "è©±é¡Œã®ã‚¹ãƒãƒƒãƒˆã¸ãŠå‡ºã‹ã‘", type: "white", weight: 2 },
        { text: "ãŠå®¶ã§æ˜ ç”»ã‚„èª­æ›¸ã‚’ã‚†ã£ãã‚Š", type: "lightRed", weight: 2 },
        { text: "å°‘ã—ãƒªãƒƒãƒãªãƒ‡ã‚£ãƒŠãƒ¼ã¸è¡Œã", type: "heavyRed", weight: 2 }
      ]
    },
    {
      id: 2,
      text: "å¥½ããªæ˜ ç”»ã‚„ãƒ‰ãƒ©ãƒã®ã‚¸ãƒ£ãƒ³ãƒ«ã¯ï¼Ÿ",
      icon: <FilmIcon />,
      options: [
        { text: "ãƒãƒƒãƒ”ãƒ¼ãªãƒ©ãƒ–ã‚³ãƒ¡ãƒ‡ã‚£", type: "sparkling", weight: 2 },
        { text: "ã‚¹ã‚«ãƒƒã¨ã™ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³", type: "white", weight: 2 },
        { text: "æ˜ åƒãŒç¶ºéº—ãªãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼", type: "lightRed", weight: 2 },
        { text: "ä¼ç·šå›åãŒã™ã”ã„ãƒŸã‚¹ãƒ†ãƒªãƒ¼", type: "heavyRed", weight: 2 }
      ]
    },
    {
      id: 3,
      text: "å‹äººã‚°ãƒ«ãƒ¼ãƒ—ã®ä¸­ã§ã®ã‚ãªãŸã®å½¹å‰²ã¯ï¼Ÿ",
      icon: <UsersIcon />,
      options: [
        { text: "ç››ã‚Šä¸Šã’å½¹ãƒ»ãƒ ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼", type: "sparkling", weight: 2 },
        { text: "ä¼ç”»ææ¡ˆãƒ»å¹¹äº‹å½¹", type: "heavyRed", weight: 2 },
        { text: "èãå½¹ãƒ»ç›¸è«‡å½¹", type: "lightRed", weight: 2 },
        { text: "ãƒ„ãƒƒã‚³ãƒŸå½¹ãƒ»è‡ªç”±äºº", type: "white", weight: 2 }
      ]
    },
    {
      id: 4,
      text: "éƒ¨å±‹ã®ã‚¤ãƒ³ãƒ†ãƒªã‚¢ã®é›°å›²æ°—ã¯ï¼Ÿ",
      icon: <HomeIcon />,
      options: [
        { text: "ã‚«ãƒ©ãƒ•ãƒ«ã§å¯æ„›ã„æ„Ÿã˜", type: "sparkling", weight: 1 },
        { text: "ã‚·ãƒ³ãƒ—ãƒ«ã§æ©Ÿèƒ½çš„", type: "white", weight: 1 },
        { text: "é–“æ¥ç…§æ˜ãŒã‚ã‚‹è½ã¡ç€ã„ãŸæ„Ÿã˜", type: "lightRed", weight: 1 },
        { text: "é«˜ç´šæ„Ÿã®ã‚ã‚‹ãƒ¢ãƒ€ãƒ³ãªæ„Ÿã˜", type: "heavyRed", weight: 1 }
      ]
    },
    {
      id: 5,
      text: "ä»Šã€ä¸€ç•ªé£Ÿã¹ãŸã„ã‚‚ã®ã¯ï¼Ÿ",
      icon: <UtensilsIcon />,
      options: [
        { text: "ç”˜ã„ã‚¹ã‚¤ãƒ¼ãƒ„å…¨èˆ¬", type: "sparkling", weight: 2 },
        { text: "æ–°é®®ãªã‚·ãƒ¼ãƒ•ãƒ¼ãƒ‰ã‚„ã‚µãƒ©ãƒ€", type: "white", weight: 2 },
        { text: "ç…®è¾¼ã¿æ–™ç†ã‚„ãƒãƒ¼ã‚º", type: "lightRed", weight: 2 },
        { text: "ã‚¬ãƒƒãƒ„ãƒªãŠè‚‰ï¼ã‚¹ãƒ†ãƒ¼ã‚­ï¼", type: "heavyRed", weight: 2 }
      ]
    }
  ];

  // è¨ºæ–­çµæœãƒ‡ãƒ¼ã‚¿
  const resultsData = {
    sparkling: {
      title: "å¤©çœŸçˆ›æ¼«ãªã€Œæ„›ã•ã‚Œã‚¢ã‚¤ãƒ‰ãƒ«ã€ã‚¿ã‚¤ãƒ—",
      catchphrase: "ã‚­ãƒ©ã‚­ãƒ©è¼ãæ³¡ã®ã‚ˆã†ã«ã€å ´ã‚’æ˜ã‚‹ãã™ã‚‹å¤©æ‰ã€‚",
      wineName: "ãƒ—ãƒ­ã‚»ãƒƒã‚³ï¼ˆã‚¤ã‚¿ãƒªã‚¢ç”£ã‚¹ãƒ‘ãƒ¼ã‚¯ãƒªãƒ³ã‚°ï¼‰",
      description: "ã‚ãªãŸã¯æ„Ÿæƒ…è±Šã‹ã§ã€å‘¨ã‚Šã®äººã‚’ç¬‘é¡”ã«ã™ã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æŒã£ã¦ã„ã¾ã™ã€‚ãã‚“ãªã‚ãªãŸã«ã¯ã€ãƒ•ãƒ«ãƒ¼ãƒ†ã‚£ã§è¯ã‚„ã‹ãªã‚¹ãƒ‘ãƒ¼ã‚¯ãƒªãƒ³ã‚°ãƒ¯ã‚¤ãƒ³ãŒã´ã£ãŸã‚Šã€‚å¥³å­ä¼šã‚„ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã®ä¹¾æ¯ã«æœ€é©ã§ã™ã€‚",
      tags: ["#ãƒ ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼", "#ãƒˆãƒ¬ãƒ³ãƒ‰å¥½ã", "#ç”˜ãˆä¸Šæ‰‹"],
      color: "from-pink-400 to-rose-400",
      textColor: "text-pink-600",
      imageEmoji: "ğŸ¥‚",
      food: "ãƒ•ãƒ«ãƒ¼ãƒ„ã‚¿ãƒ«ãƒˆã€ç”Ÿãƒãƒ "
    },
    white: {
      title: "çˆ½ã‚„ã‹ãªã€Œè‡ªç”±ãªå†’é™ºå®¶ã€ã‚¿ã‚¤ãƒ—",
      catchphrase: "ã‚­ãƒªãƒƒã¨ã—ãŸé…¸å‘³ã®ã‚ˆã†ã«ã€è£è¡¨ã®ãªã„ã‚µãƒã‚µãƒç³»ã€‚",
      wineName: "ã‚½ãƒ¼ãƒ´ã‚£ãƒ‹ãƒ¨ãƒ³ãƒ»ãƒ–ãƒ©ãƒ³ï¼ˆç™½ãƒ¯ã‚¤ãƒ³ï¼‰",
      description: "ã‚ãªãŸã¯å¥½å¥‡å¿ƒæ—ºç››ã§ã€è‡ªåˆ†ã®è€ƒãˆã‚’ã—ã£ã‹ã‚ŠæŒã£ã¦ã„ã¾ã™ã€‚åªšã³ãªã„é­…åŠ›ã‚’æŒã¤ã‚ãªãŸã«ã¯ã€ãƒãƒ¼ãƒ–ã®ã‚ˆã†ãªé¦™ã‚Šã¨ã‚­ãƒ¬ã®ã‚ã‚‹é…¸å‘³ãŒç‰¹å¾´ã®ç™½ãƒ¯ã‚¤ãƒ³ãŒãƒ™ã‚¹ãƒˆãƒãƒƒãƒã€‚ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã—ãŸã„æ™‚ã«ã€‚",
      tags: ["#ã‚µãƒã‚µãƒç³»", "#ã‚¢ã‚¯ãƒ†ã‚£ãƒ–", "#ã‚»ãƒ³ã‚¹æŠœç¾¤"],
      color: "from-yellow-300 to-lime-400",
      textColor: "text-lime-700",
      imageEmoji: "ğŸŒ¿",
      food: "ã‚«ãƒ«ãƒ‘ãƒƒãƒãƒ§ã€ã‚°ãƒªãƒ«ãƒã‚­ãƒ³"
    },
    lightRed: {
      title: "çŸ¥çš„ãªã€Œãƒ­ãƒãƒ³ãƒã‚¹ãƒˆã€ã‚¿ã‚¤ãƒ—",
      catchphrase: "ç¹Šç´°ã§è¤‡é›‘ãªé¦™ã‚Šã€‚ç‹¬ç‰¹ã®ä¸–ç•Œè¦³ã‚’æŒã¤èŠ¸è¡“å®¶ã€‚",
      wineName: "ãƒ”ãƒãƒ»ãƒãƒ¯ãƒ¼ãƒ«ï¼ˆèµ¤ãƒ¯ã‚¤ãƒ³ï¼‰",
      description: "ã‚ãªãŸã¯æ„Ÿå—æ€§ãŒå¼·ãã€ç¾æ„è­˜ãŒé«˜ã„ã‚¿ã‚¤ãƒ—ã€‚ä¸€äººã®æ™‚é–“ã‚’å¤§åˆ‡ã«ã™ã‚‹ã‚ãªãŸã«ã¯ã€ã‚¤ãƒã‚´ã‚„ãƒã‚§ãƒªãƒ¼ã®ã‚ˆã†ãªç¹Šç´°ãªé¦™ã‚ŠãŒæ¥½ã—ã‚ã‚‹ã€ä¸Šå“ãªèµ¤ãƒ¯ã‚¤ãƒ³ãŒå¿ƒã«å¯„ã‚Šæ·»ã„ã¾ã™ã€‚",
      tags: ["#ãƒŸã‚¹ãƒ†ãƒªã‚¢ã‚¹", "#ç¾æ„è­˜é«˜ã„", "#èãä¸Šæ‰‹"],
      color: "from-red-400 to-purple-500",
      textColor: "text-purple-700",
      imageEmoji: "ğŸ·",
      food: "é´¨è‚‰ã®ãƒ­ãƒ¼ã‚¹ãƒˆã€ãƒˆãƒªãƒ¥ãƒ•"
    },
    heavyRed: {
      title: "æƒ…ç†±çš„ãªã€Œã‚«ãƒªã‚¹ãƒãƒªãƒ¼ãƒ€ãƒ¼ã€ã‚¿ã‚¤ãƒ—",
      catchphrase: "åŠ›å¼·ãæ¿ƒåšã€‚å‘¨ã‚Šã‚’å¼•ã£å¼µã‚‹é ¼ã‚Œã‚‹å­˜åœ¨ã€‚",
      wineName: "ã‚«ãƒ™ãƒ«ãƒãƒ»ã‚½ãƒ¼ãƒ´ã‚£ãƒ‹ãƒ¨ãƒ³ï¼ˆèµ¤ãƒ¯ã‚¤ãƒ³ï¼‰",
      description: "ã‚ãªãŸã¯ç›®æ¨™ã«å‘ã‹ã£ã¦åŠªåŠ›ã§ãã‚‹é‡å¿ƒå®¶ã€‚è«–ç†çš„ã§æ±ºæ–­åŠ›ãŒã‚ã‚Šã¾ã™ã€‚ãã‚“ãªã‚ãªãŸã«ã¯ã€ã‚¿ãƒ³ãƒ‹ãƒ³ï¼ˆæ¸‹ã¿ï¼‰ãŒã—ã£ã‹ã‚Šã—ãŸæ¿ƒåšãªãƒ•ãƒ«ãƒœãƒ‡ã‚£ã®èµ¤ãƒ¯ã‚¤ãƒ³ãŒã€æˆåŠŸã¸ã®æ´»åŠ›ã‚’ä¸ãˆã¦ãã‚Œã¾ã™ã€‚",
      tags: ["#ä»•äº‹ã§ãã‚‹", "#å§‰å¾¡è‚Œ", "#ã‚°ãƒ«ãƒ¡"],
      color: "from-purple-800 to-indigo-900",
      textColor: "text-indigo-900",
      imageEmoji: "ğŸ‡",
      food: "ç†Ÿæˆã‚¹ãƒ†ãƒ¼ã‚­ã€ãƒãƒ¼ãƒ‰ãƒãƒ¼ã‚º"
    }
  };

  const handleAnswer = (type, weight) => {
    setScores(prev => ({
      ...prev,
      [type]: prev[type] + weight
    }));

    if (currentQuestionIndex < questions.length - 1) {
      setCurrentQuestionIndex(prev => prev + 1);
    } else {
      setStep('analyzing');
    }
  };

  const calculateResult = () => {
    // ã‚¹ã‚³ã‚¢ãŒä¸€ç•ªé«˜ã„ã‚¿ã‚¤ãƒ—ã‚’åˆ¤å®š
    const maxScore = Math.max(...Object.values(scores));
    const resultType = Object.keys(scores).find(key => scores[key] === maxScore);
    setResult(resultsData[resultType] || resultsData.sparkling); // fallback
  };

  useEffect(() => {
    if (step === 'analyzing') {
      calculateResult();
      const timer = setTimeout(() => {
        setStep('result');
      }, 2500);
      return () => clearTimeout(timer);
    }
  }, [step]);

  const restartQuiz = () => {
    setScores({ sparkling: 0, white: 0, lightRed: 0, heavyRed: 0 });
    setCurrentQuestionIndex(0);
    setStep('intro');
  };

  // --- Components ---

  const IntroScreen = () => (
    <div className="flex flex-col items-center justify-center h-full p-6 text-center animate-fade-in">
      <div className="mb-6 relative">
        <div className="absolute inset-0 bg-purple-200 rounded-full blur-xl opacity-50 animate-pulse"></div>
        <div className="relative bg-gradient-to-br from-purple-600 to-pink-500 text-white p-6 rounded-full shadow-xl">
          <Wine size={64} />
        </div>
      </div>
      <h1 className="text-3xl font-bold text-gray-800 mb-2">
        <span className="text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-500">Wine</span> Personality
      </h1>
      <p className="text-gray-500 mb-8 font-medium">æ€§æ ¼ã§é¸ã¶ã€ã‚ãªãŸã ã‘ã®é‹å‘½ã®1æœ¬ã€‚</p>
      
      <div className="bg-white p-6 rounded-2xl shadow-md mb-8 w-full max-w-sm">
        <p className="text-sm text-gray-600 mb-4">
          ã€Œãƒ¯ã‚¤ãƒ³ã¯è©³ã—ããªã„ã‘ã©ã€ç¾å‘³ã—ã„ãŠé…’ã¯å¥½ãã€<br/>
          ãã‚“ãªã‚ãªãŸã®ãŸã‚ã®AIè¨ºæ–­ã€‚
          5ã¤ã®è³ªå•ã«ç­”ãˆã‚‹ã ã‘ã§ã€ã‚ãªãŸã®æ€§æ ¼ã«ã´ã£ãŸã‚Šã®ãƒ¯ã‚¤ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã™ã€‚
        </p>
        <div className="flex justify-center gap-2 text-xs text-gray-400">
          <span>#æ‰€è¦æ™‚é–“1åˆ†</span>
          <span>#çŸ¥è­˜ä¸è¦</span>
        </div>
      </div>

      <button 
        onClick={() => setStep('quiz')}
        className="w-full max-w-xs bg-gray-900 text-white font-bold py-4 px-8 rounded-full shadow-lg transform transition hover:scale-105 hover:shadow-xl flex items-center justify-center gap-2"
      >
        è¨ºæ–­ã‚’ã‚¹ã‚¿ãƒ¼ãƒˆ <ArrowRight size={18} />
      </button>
    </div>
  );

  const QuizScreen = () => {
    const question = questions[currentQuestionIndex];
    const progress = ((currentQuestionIndex + 1) / questions.length) * 100;

    return (
      <div className="flex flex-col h-full p-6 max-w-md mx-auto animate-slide-up">
        {/* Progress Bar */}
        <div className="w-full bg-gray-200 rounded-full h-2 mb-8">
          <div 
            className="bg-gradient-to-r from-purple-500 to-pink-500 h-2 rounded-full transition-all duration-500 ease-out"
            style={{ width: `${progress}%` }}
          ></div>
        </div>

        <div className="flex-1 flex flex-col justify-center">
          <h2 className="text-xl font-bold text-gray-800 mb-2">Q{question.id}.</h2>
          <h3 className="text-2xl font-bold text-gray-900 mb-8 leading-relaxed">
            {question.text}
          </h3>

          <div className="space-y-4">
            {question.options.map((option, idx) => (
              <button
                key={idx}
                onClick={() => handleAnswer(option.type, option.weight)}
                className="w-full text-left p-4 bg-white border-2 border-gray-100 rounded-xl hover:border-purple-500 hover:bg-purple-50 transition-all duration-200 shadow-sm group"
              >
                <div className="flex items-center justify-between">
                  <span className="font-medium text-gray-700 group-hover:text-purple-700">{option.text}</span>
                  <div className="w-5 h-5 rounded-full border-2 border-gray-300 group-hover:border-purple-500 group-hover:bg-purple-500 transition-colors"></div>
                </div>
              </button>
            ))}
          </div>
        </div>
        
        <div className="mt-8 text-center text-gray-400 text-xs">
          ç›´æ„Ÿã§ãŠç­”ãˆãã ã•ã„
        </div>
      </div>
    );
  };

  const LoadingScreen = () => (
    <div className="flex flex-col items-center justify-center h-full p-6 text-center animate-fade-in bg-gray-50">
      <div className="relative mb-8">
        <div className="absolute inset-0 bg-pink-300 rounded-full blur-xl opacity-60 animate-ping"></div>
        <div className="relative bg-white p-6 rounded-full shadow-xl">
           <GlassWater size={48} className="text-purple-600 animate-bounce" />
        </div>
      </div>
      <h2 className="text-2xl font-bold text-gray-800 mb-2">åˆ†æä¸­...</h2>
      <p className="text-gray-500">ã‚ãªãŸã®æ€§æ ¼ãƒ‡ãƒ¼ã‚¿ã‚’è§£æã—ã¦ã„ã¾ã™</p>
      
      <div className="mt-8 flex gap-2">
        <div className="w-2 h-2 bg-purple-500 rounded-full animate-bounce" style={{ animationDelay: '0s' }}></div>
        <div className="w-2 h-2 bg-pink-500 rounded-full animate-bounce" style={{ animationDelay: '0.2s' }}></div>
        <div className="w-2 h-2 bg-purple-500 rounded-full animate-bounce" style={{ animationDelay: '0.4s' }}></div>
      </div>
    </div>
  );

  const ResultScreen = () => {
    if (!result) return null;

    return (
      <div className="flex flex-col h-full bg-white animate-fade-in overflow-y-auto">
        {/* Header Image Area */}
        <div className={`w-full h-48 bg-gradient-to-br ${result.color} flex items-center justify-center relative overflow-hidden shrink-0`}>
          <div className="absolute inset-0 bg-white/10 pattern-dots"></div>
          <div className="text-8xl animate-float drop-shadow-lg z-10">{result.imageEmoji}</div>
          <div className="absolute bottom-0 left-0 w-full h-8 bg-white rounded-t-3xl"></div>
        </div>

        <div className="px-6 pb-20 -mt-2">
          {/* Result Type Badge */}
          <div className="flex justify-center mb-4">
            <span className={`px-4 py-1 rounded-full bg-gray-100 text-sm font-bold tracking-wider ${result.textColor}`}>
              WINE PERSONALITY
            </span>
          </div>

          <h2 className={`text-2xl font-black text-center text-gray-900 mb-2 leading-tight`}>
            {result.title}
          </h2>
          <p className="text-center text-gray-500 text-sm mb-6 font-medium">
            "{result.catchphrase}"
          </p>

          {/* Tags */}
          <div className="flex justify-center gap-2 mb-8 flex-wrap">
            {result.tags.map((tag, i) => (
              <span key={i} className="text-xs bg-gray-50 border border-gray-200 px-3 py-1 rounded-full text-gray-600">
                {tag}
              </span>
            ))}
          </div>

          {/* Diagnosis Content */}
          <div className="bg-gray-50 rounded-2xl p-6 mb-8 relative border border-gray-100">
            <div className="absolute -top-3 left-6 bg-white px-2 py-1 text-xs font-bold text-gray-400 border border-gray-200 rounded">
              æ€§æ ¼åˆ†æ
            </div>
            <p className="text-gray-700 leading-relaxed text-sm text-justify">
              {result.description}
            </p>
          </div>

          {/* Wine Recommendation Card */}
          <div className="bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden mb-8 transform transition hover:scale-[1.02]">
            <div className="bg-gray-900 text-white py-2 px-4 text-center text-xs font-bold tracking-widest">
              BEST MATCH WINE
            </div>
            <div className="p-6">
              <div className="flex items-start gap-4 mb-4">
                <div className={`w-16 h-16 rounded-lg bg-gradient-to-br ${result.color} flex items-center justify-center text-3xl shadow-inner shrink-0`}>
                  {result.imageEmoji}
                </div>
                <div>
                  <h3 className="font-bold text-lg text-gray-800 leading-tight mb-1">{result.wineName}</h3>
                  <div className="flex items-center gap-1 text-xs text-yellow-500">
                    <Star size={12} fill="currentColor" />
                    <Star size={12} fill="currentColor" />
                    <Star size={12} fill="currentColor" />
                    <Star size={12} fill="currentColor" />
                    <Star size={12} fill="currentColor" />
                    <span className="text-gray-400 ml-1">(4.8)</span>
                  </div>
                </div>
              </div>
              
              <div className="flex gap-2 mb-6">
                <div className="flex-1 bg-gray-50 rounded p-2 text-center">
                  <div className="text-[10px] text-gray-400 mb-1">ç›¸æ€§ã®è‰¯ã„æ–™ç†</div>
                  <div className="text-xs font-bold text-gray-700">{result.food}</div>
                </div>
              </div>

              <button className={`w-full bg-gradient-to-r ${result.color} text-white font-bold py-3 px-4 rounded-xl shadow-lg flex items-center justify-center gap-2 hover:opacity-90 transition-opacity`}>
                <ShoppingBag size={18} />
                <span>ã“ã®ãƒ¯ã‚¤ãƒ³ã‚’è¦‹ã‚‹</span>
              </button>
              <div className="text-center mt-2 text-[10px] text-gray-400">
                â€»åˆå›è³¼å…¥é™å®š 10%OFFã‚¯ãƒ¼ãƒãƒ³é©ç”¨æ¸ˆã¿
              </div>
            </div>
          </div>

          {/* Action Buttons */}
          <div className="flex gap-3">
             <button onClick={restartQuiz} className="flex-1 py-3 border border-gray-300 rounded-xl text-gray-600 font-bold text-sm hover:bg-gray-50 flex items-center justify-center gap-2">
               <RefreshCw size={16} /> ã‚‚ã†ä¸€åº¦è¨ºæ–­
             </button>
             <button className="flex-1 py-3 bg-blue-500 text-white rounded-xl font-bold text-sm hover:bg-blue-600 flex items-center justify-center gap-2 shadow-md">
               <Share2 size={16} /> çµæœã‚’ã‚·ã‚§ã‚¢
             </button>
          </div>

        </div>
      </div>
    );
  };

  // --- Main Render ---
  return (
    <div className="w-full min-h-screen bg-gray-100 flex items-center justify-center font-sans text-gray-800">
      <div className="w-full max-w-md h-[800px] max-h-screen bg-white shadow-2xl sm:rounded-[30px] overflow-hidden relative flex flex-col">
        {step === 'intro' && <IntroScreen />}
        {step === 'quiz' && <QuizScreen />}
        {step === 'analyzing' && <LoadingScreen />}
        {step === 'result' && <ResultScreen />}
      </div>

      {/* Styles for animations */}
      <style>{`
        @keyframes float {
          0%, 100% { transform: translateY(0px); }
          50% { transform: translateY(-10px); }
        }
        .animate-float {
          animation: float 3s ease-in-out infinite;
        }
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        .animate-fade-in {
          animation: fade-in 0.5s ease-out forwards;
        }
        @keyframes slide-up {
          from { opacity: 0; transform: translateY(20px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-slide-up {
          animation: slide-up 0.4s ease-out forwards;
        }
        .pattern-dots {
          background-image: radial-gradient(#ffffff 1px, transparent 1px);
          background-size: 20px 20px;
        }
      `}</style>
    </div>
  );
}

// Simple Icon Components for Quiz (to avoid external SVG dependency issues in preview)
const SunIcon = () => <div className="text-3xl">â˜€ï¸</div>;
const FilmIcon = () => <div className="text-3xl">ğŸ¬</div>;
const UsersIcon = () => <div className="text-3xl">ğŸ‘¯â€â™€ï¸</div>;
const HomeIcon = () => <div className="text-3xl">ğŸ </div>;
const UtensilsIcon = () => <div className="text-3xl">ğŸ½ï¸</div>;
